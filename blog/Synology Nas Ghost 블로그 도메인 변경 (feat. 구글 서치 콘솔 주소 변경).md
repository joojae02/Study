
![](https://i.imgur.com/y7krAoS.jpg)

현재 나스 도커에 고스트를 띄워 블로그를 운영 중 

기존 도메인인 blog.joojae.synology.me 에서
synology 부분이 너무 맘에 안들어.. 도메인을 변경하기로 결정

## 구글 서치 문제
이미 기존 도메인으로 구글 SEO 설정을 마쳤었기 때문에....
기존 순위들을 가져가고 싶었음

그러기 위해선 구글 서치 콘솔에서 도메인 이전 신청을 해줘야함
![](https://i.imgur.com/IsGJx24.png)

여기서 문제는 기존 도메인과 변경하려는 도메인 모두 접속이 되야한다는 것임
쉽게 말해서 두개의 블로그가 존재해야함

- 두 도메인 소유자 인증
- 기존 주소에서 변경된 주소로 301 리다이렉션
위 두 조건을 만족해야 주소 변경이 가능해짐

해결한 방법부터 말하면 동일한 블로그를 변경하려는 도메인으로 **하나 더** 띄워줬다
> 사실 하나를 더 띄우기는 싫어서 여러 방법을 찾아봤지만 해결되지 않았음

### 기존 블로그 도메인을 바로 변경??

사실 이 방법이 가능하다면 제일 이상적이라 생각함

![](https://i.imgur.com/6HJ7cth.png)

위 사진에서 url만 변경하고자 하는 주소로 변경해주면 사용하는데는 문제가 없다

다만 문제점은 기존 주소에서 변경된 주소로 301 리다이렉션이 되어야한다는 점인데
이걸 해결할 방법을 찾지 못해서 포기..

### 두 블로그가 같은 디비를 사용하도록??
이 경우도 위 경우와 같은 문제로 실패했다

디비가 두개가 뜨면 두 주소가 독립적으로 행동할것이라 생각했지만
당연히 301 리다이렉션을 걸 경우 하나의 디비 컨테이너만 떠있기게 무한 리다이렉션이 된다

### 걍 하나 더 띄워..

기존 블로그를 띄웠던 대로 블로그, 디비를 하나씩 더 띄워준다
[시놀로지 나스에 고스트 블로그 띄우기](https://joojae.com/synology-nas-ghost-blog/)

새로 띄우게 된다면 기존에 올렸던 게시물이나 설정들이 초기화 될텐데

![](https://i.imgur.com/D2oVSCM.png)

위 사진처럼 세팅에 들어온 뒤 Labs에 들어간다

![](https://i.imgur.com/q7OxDze.png)

여기서 export 한다음 새 블로그에 import 해주자

해서 역방향 프록시도 걸어주고
인증서도 발급받아서 연결해주자

근데 그 전에 도메인 DNS 설정을 해줘야한다

### 도메인 구입 및 DNS 설정

우선 도메인을 구매해야한다ㅏ
가비아를 이용했고 가비아가 아니더라도 원하는 도메인을 구입하면 오케이

![](https://i.imgur.com/J7Ul1WH.png)

요렇게 DNS 설정을 해주자


여기까지 했다면
- 기존 도메인 블로그
- 변경 도메인 블로그
이렇게 두 블로그가 독립적으로 띄워져 있어야한다

## Ghost 리다이렉션 설정

요걸 마무리 해줘야되는데
고스트에서 자체 지원하는 리다이렉션 설정이 존재한다

![](https://i.imgur.com/D2oVSCM.png)

위 사진처럼 세팅에 들어온 뒤 Labs에 들어간다

![](https://i.imgur.com/q6Q7E98.png)

박스 안에 있는 항목에서 yaml 또는 json 파일을 업로드해주면 된다

[Redirects docs](https://ghost.org/tutorials/implementing-redirects/)
공식문서를 보고 따라해도 좋지만
간단하게 설명하면

```yaml
301:
	^/: https://<변경 도메인>/
	^/test/: https://<변경 도메인>/test/
302:
```

위 예시와 같이 적어주면 된다
정규식 또한 지원하는데
```
301:
	^/(.*): https://<변경 도메인>/$1
```

이런식으로 적으면 robots.txt, sitemap.xml 등등 리다이렉션 되면 안되는 것들까지 모두 적용되기 때문에
개인 설정에 맞게 리다이렉션 설정을 완료해준다

후에 기존 블로그에 업로드해주면 된다

마지막으로 
## 구글 서치 주소 변경 신청

서치 콘솔에서 세팅에 들어가 이전 신청을 해주고

![](https://i.imgur.com/BOwfucW.png)

위 사진처럼 나오면 성공이다

근데 찾아보니 180일 간 떠있는것 같은데
현재 블로그가 2개가 떠있어 비효율적이다...

더 나은 방법을 계속 찾아봐야할 것 같다